## 										Ajax数据交互

>何为数据交互?  =>  前后端数据的交互 (前端向后端发起数据请求 ,由后端响应数据给前端)
>
>Ajax : 在浏览器与服务器之间异步加载数据 . (web2.0重要技术) 可以在不重载整个页面的情况下 ,更新页面的某一块内容 

> ##### 因涉及后端数据交互 ,所以需要有后端服务.(后台 / 服务器环境)

##### 准备工作: 搭建一个本地开发测试(服务器)环境 

搭建一台本地的web服务器 ,让自己的pc充当为一台本地的服务器(其实就是一台性能比普通电脑更高的电脑,24小时不关机,给其他的pc或终端提供服务使用).

目前主流的服务器的操作系统:

1. windows server 2008 (窗口式操作)
2. Linux (centOS )
3. Unix

常见的服务:

​	web服务:搭建网站提供给互联网用户访问

​	smtp服务: 提供电子邮件发送服务

​	ftp服务: 提供文件共享服务(传输)

---

##### 常用于搭建web服务的软件:

1. IIS 微软 因特网信息服务  (运行在windows服务器上)

2. Apache  (linux , windows)

3. Nginx (linux) (推荐 ,服务器首选)

4. Nodejs  (linux , windows)

5. Tomcat  (linux , windows)

   ###### 在真实项目的上一般会选用Linux操作系统(nginx / apache)的服务器 (小型,或者个人项目可能会使用IIS的windows服务)	

​	本地的开发测试环境 ,可以使用一些集成的环境 = > XAMPP

​	XAMPP集成:

​			1.Apache (阿帕奇服务)

​			2.PHP (后端语言)

​			3.Mysql (数据库)

​			4.FileZilla ( FTP 服务 )	

​			5.Tomcat (运行java web的服务)		

---

安装完 XAMPP 打开控制面板 ,start 启动 apache 服务 ,服务默认会运行在80端口  , 

###### 	访问方式:

​	(本地)

1. http://localhost  (localhost 是本地的主机名称 , 只能访问当前设备上的服务) 

2. http://127.0.0.1 (所有的网络设备 ,都有一个本地的回路地址 : 127.0.0.1 )

   ###### 可以访问其他的网络设备提供的服务

3. 172.16.4.1  (可以使用为当前网络下 ,可以被访问的其他设备的web服务) 

4. http://class4  (class4名称是当前运行apache服务的计算机名) 相当于  www.baidu.com

    安装目录下的 : htdocs (存放网站程序的目录)  web服务默认会以网站根目录下 ,文件名为 index的文件作为当前站点的首页

   ---

   ###### 使用FTP 上传 文件 至服务器 

   ftp 地址 :  ftp://class4  

   账号: wt18

   密码: 123456

---

> 浏览器的地址栏 , 输入 www.baidu.com 然后按回车 =>  发生了什么事情?
>
> ##### 互联网上通信 , 只能通过 IP 地址进行寻址 .
>
> 1.按下回车 : 先对需要访问的域名进行解析   = >  DNS (域名解析 )  将域名解析为对应的 ip 地址 
>
> ​		解析:  1. 本地解析 (优先使用)  2. DNS服务解析
>
> 2.地址解析成功之后 , 就直接进行http请求访问...	 

###### 经常在开发场景中 , 需要模拟多站点通信  , apache 运行配置多个虚拟主机 :

1. ###### 配置本地的解析文件 : C:\Windows\System32\drivers\etc\hosts  (在很多软件破解时也会使用到)

   1. 配置一个本地域名 m.com
   2. 配置一个本地域名 s.com

~~~
127.0.0.1  		m.com
127.0.0.1  		s.com 
~~~

###### 2.配置apache 的虚拟主机 

找到apahce 的安装目录  (E:\xampp\apache\conf\extra\httpd-vhosts.conf)

参考配置如下:

~~~
#配置 s.com
<VirtualHost*:80>
    ServerAdmin admin@s.com
    DocumentRoot "/xampp/htdocs/s.com"
    ServerName s.com
</VirtualHost>

#配置 m.com
<VirtualHost*:80>
    ServerAdmin admin@m.com
    DocumentRoot "/xampp/htdocs/m.com"
    ServerName m.com
</VirtualHost>
~~~

所有的配置 ,修改完之后 ,都需要重启 apache 服务 生效.

---

搭环境与不搭环境的区别:

​	http服务环境:  http://m.com

​	没有环境: file:///E:/xampp/htdocs/s.com/index.html

---

##### jQuery 中的ajax:

###### 	(万能)ajax()

~~~javascript
ajax({
	url:"请求的服务器的url地址", //[必须]
    type:"get",// post , put , delete 请求方式   (method 也可以 , 效果一样)
    data:"需要发送给服务器的数据",
    dataType:'服务器返回的数据类型',//text , html ,css , script , json , jsonp
    async:true,//(默认为true) 是否异步操作 
    beforeSend:function(){//开始发送请求执行 执行
        
    },
    complete:function(){//请求过程结束(完成, 无论成功失败)
        
    },
    success:function(data){//请求成功的回调函数 ,  data 请求成功的数据
        
    },
    error:function(error){//请求失败 执行
        
    }
})
~~~

---

###### 异步: 在同一时刻 ,在执行一个任务时 ,也可以继续执行其他任务

###### 同步:在同一时刻,同时只能处理一个任务 (V8引擎 , 每次同时只能处理一个js任务) ,如果该任务还未执行完毕,那么下一个任务,就要等待该任务执行完之后才能进行.

  注意:浏览器js引擎是单线程应用,每次只能执行一个任务 , 如果此时为同步请求 ,(请求时间稍长一些就更明显) ,会导致js 引擎运行暂停(堵塞)  造成 = > "页面假死" 



###### 页面假死 : 1.页面的交互无响应 (右键无反应 , 包括浏览器中的一些事件处理都将失去反应)  2.暂停渲染

---

###### 	post() : 通过http post方式发起请求

~~~
post(请求服务器地址[必须],发送的数据,请求成功回调函数,服务器返回数据类型)
~~~

###### 	get() :通过http get方式发起请求

~~~
get(请求服务器地址[必须],发送的数据,请求成功回调函数,服务器返回数据类型)
~~~

###### 	getScript() : 通过http get请求方式 ,获取服务器上的一段 js脚本 ,并运行

~~~
getScript(请求服务器地址[必须])
~~~

######    load() : 使用在jQ对象上 ,直接把请求的内容显示到对应的DOM上

###### getJSON() : 使用get 请求 ,获取服务器上的json数据

---

(主流 )JSON : 是JavaScript 对象的表示方式 ,用于数据交换格式.

~~~js
//json格式 ,就是组键值对关系  = > 对象的形式 (通过对象属性方式调用 .属性名)
{
	"键名1":键值1,
    "键名2":键值2,
    "键名3":键值3   
}

//数组形式 (使用时候 ,用下标找到对应的对象 )
[
   {
	"键名1":键值1,
    "键名2":键值2,
    "键名3":键值3   
},{
	"键名1":键值1,
    "键名2":键值2,
    "键名3":键值3   
},{
	"键名1":键值1,
    "键名2":键值2,
    "键名3":键值3   
}
]

~~~



(已经逐步淘汰)XML: 是一种互联网应用交换数据格式 (xml是扩展型标记语言 ,类似于html)

###### XML与JSON的区别

~~~
详见 : https://www.jianshu.com/p/243deb64bcb5
~~~

###### 需要具备一定的数据结构设计能力. ( 对后端提供的数据要求 , 编写模拟数据)

模拟数据 , 数据结构与真实的后端接口数据格式一致 ,但是是本地模拟使用,用于在前后端开发时 ,后端暂未将后台的接口数据开发完时,提供前端本地开发模拟使用.

---

~~~js
轮播图:
	每张轮播图需要的数据 : 1. 图片的地址  2.图片的跳转链接地址
	{
		picUrl:"图片地址",
		url:"点击的超链接跳转地址"
	}

	
	[
		{
		  picUrl:"图片地址",
		  url:"点击的超链接跳转地址"
	   },{
		  picUrl:"图片地址",
		  url:"点击的超链接跳转地址"
	   },{
		  picUrl:"图片地址",
		  url:"点击的超链接跳转地址"
	   },{
		  picUrl:"图片地址",
		  url:"点击的超链接跳转地址"
	   },{
		  picUrl:"图片地址",
		  url:"点击的超链接跳转地址"
	   }
	]

例举京东单个商品展示列表 :
	商品的6款型号图片 \ 价格 \ 商品的标题 \ 评价的数量 \ 店铺的名称 \ 商品的跳转链接 \ 店铺的链接 \ 评价的跳转链接 \ 是否二手在售 ,跳转地址 \ 商品的特性 \ 商品的SID \ 是否广告 \ 客服的地址
~~~

---

##### 渲染: 

###### 	1.后端渲染:

​		服务端在返回 html 之前，在特定的区域，符号里用数据填充，再给客户端，客户端只负责解析 HTML 

​	

###### 	2.前端渲染(客户端渲染):

​		html 仅仅作为静态文件，客户端端在请求时，服务端不做任何处理，直接以原文件的形式返回给客户端客户端，然后根据 html 上的 JavaScript，生成 DOM 插入 html。



##### 前端渲染不利于SEO优化(内容需要在客户端通过js生成,所以爬虫抓取的时候是没有内容的,或者内容不多)

<https://www.jianshu.com/p/0719c6102639>

~~~
京东左侧导航分类 接口地址:https://dc.3.cn/category/get?&callback=getCategoryCallback
~~~

---

##### 发送数据:

###### GET请求方式

~~~
通过请求的地址中传递发送给后台的数据 = > QueryString (查询字符串)

http://m.com/api/?name=张三&age=20&sex=男
~~~

###### POST请求方式

~~~
通过post特定方式传输 
格式可以为 QueryString  / 表单数据 (字符串)
~~~

[注意] : 前后端数据交互中 , 没有json对象的概念 (php没有json对象的概念的,因为json是js中对象的表示形式)

虽然php中不存在json对象 ,但是为了更方便于前端js交互 ,后端有 json字符串(长得像json格式的字符串)的概念. (但是数据的类型其实就是字符串)

~~~
 一般的后台返回的数据格式 ,其实就是字符串类型数据 (只不过外观长得像json) = > json 字符串
~~~

---

##### 前端处理json字符串格式数据:

~~~
//1.json序列化  = > 将json字符串 , 解析为json对象  (方便js使用)
JSON.parse()

//2.json反序列化  = > 将json对象 ,转换为json字符串 (一般在发送对象格式数据给后台 , 进行对象格式数据的存储之类操作)
JSON.stringify()

~~~

---

##### 1.原生ajax (基础的原理)

##### 2.http协议

##### 3.跨域 / 浏览器同源策略